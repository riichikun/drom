limitDromKitCollectionItems=4;deletedDromKitCollectionItems=new Map;DromKitCollectionItemKey=0;executeFunc(function initDromTokenKits(){const form=new FormData(document.forms.drom_token_new_edit_form);const dromTokenFormHTMLs=document.forms.drom_token_new_edit_form;const kitCollectionBtnAdd=document.getElementById("kit_сollection_add");kitCollectionBtnAdd.addEventListener("click",addKitItem);const currentDeleteBtns=document.getElementById("kit_сollection").querySelectorAll(".del-item-kit");if(currentDeleteBtns){deleteKitItem(currentDeleteBtns)}return true});function addKitItem(){const kitCollection=document.getElementById("kit_сollection");DromKitCollectionItemKey=this.dataset.index;if(deletedDromKitCollectionItems.size>0){let last="";deletedDromKitCollectionItems.forEach(function(value){last=value});DromKitCollectionItemKey=last;deletedDromKitCollectionItems.delete("key"+last)}const prototypeName=this.dataset.prototype;const prototypeElement=document.getElementById(prototypeName);let prototypeContent=prototypeElement.dataset.prototype;let index=parseInt(this.dataset.index)+1;this.setAttribute("data-index",index);if(parseInt(this.dataset.index)>limitDromKitCollectionItems){this.setAttribute("data-index",limitDromKitCollectionItems);return}prototypeContent=prototypeContent.replace(/__kit__/g,DromKitCollectionItemKey);const parser=new DOMParser;const result=parser.parseFromString(prototypeContent,"text/html");const prototypItem=result.getElementById("prototypeItem").querySelector(".item-kit");kitCollection.append(prototypItem);const deleteBtns=kitCollection.querySelectorAll(".del-item-kit");deleteKitItem(deleteBtns)}function deleteKitItem(buttons){buttons.forEach(function(btn){btn.addEventListener("click",function(){let deteteItemId=btn.id.replace(/delete-/g,"");const itemForDelete=document.getElementById(deteteItemId);const deleteIndex=btn.id.replace(/delete-drom_token_form_kit-/g,"");deletedDromKitCollectionItems.set("key"+deleteIndex,deleteIndex);if(itemForDelete){let addBtn=document.getElementById("kit_сollection_add");const newIndex=parseInt(addBtn.dataset.index)-1;addBtn.setAttribute("data-index",newIndex);itemForDelete.remove()}})})}